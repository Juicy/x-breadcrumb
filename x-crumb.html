<link rel="import" href="../polymer/polymer.html">

<dom-module id="x-crumb">
    <template>
        <style>
            :host {
                display: block;
                max-height: 600px;
            }

            /*.button {
                border: 1px solid #3d5b92;
                background: #4d72b5;
                color: #fff;
                -webkit-font-smoothing: antialiased;
                font-weight: bold;
                padding: 0.3em .75em 0.4em;
                line-height: 1;
                -moz-border-radius: 2px;
                -webkit-border-radius: 2px;
                border-radius: 2px;
                text-decoration: none;
                -moz-transition-property: background-color;
                -o-transition-property: background-color;
                -webkit-transition-property: background-color;
                transition-property: background-color;
                -moz-transition-duration: 350ms;
                -o-transition-duration: 350ms;
                -webkit-transition-duration: 350ms;
                transition-duration: 350ms;
                -moz-transition-timing-function: ease-in-out;
                -o-transition-timing-function: ease-in-out;
                -webkit-transition-timing-function: ease-in-out;
                transition-timing-function: ease-in-out;
                cursor: pointer;
                display: inline-block;
            }

            .button:hover {
                text-decoration: none;
            }*/

            .btn-large {
                padding: 1em;
                text-align: center;
            }

            .btn-create:before {
                content: "+";
                padding-right: .5em;
                font-weight: bold;
            }

            .btn-create.btn-large {
                position: relative;
                padding-left: 3em;
                padding-right: 1.5em;
            }

            .btn-create.btn-large:before {
                content: "+";
                font-size: 2em;
                position: absolute;
                left: 16px;
                left: 1rem;
                top: 6.4px;
                top: 0.4rem;
            }

            /*.button-dropdown {
                position: relative;
                display: inline-block;
                padding-bottom: 15px;
            }

            .button-dropdown .btn-create {
                -moz-border-radius: 3px 0 0 3px;
                -webkit-border-radius: 3px;
                border-radius: 3px 0 0 3px;
            }*/

            li label {
                margin-top: 2px;
                margin-bottom: 2px;
                color: white;
                text-decoration: none;
                padding: 10px 30px 10px 45px;
                position: relative;
                display: block;
                z-index: 1;
            }

            li label:after {
                content: " ";
                display: block;
                width: 90%;
                height: 50%;
                position: absolute;
                top: 0px;
                left: 0px;
                z-index: -1;
            }

            li label:before {
                content: " ";
                display: block;
                width: 90%;
                height: 50%;
                position: absolute;
                bottom: 0px;
                left: 0px;
                z-index: -1;
            }

            li label:hover:after {
                background: linear-gradient(to bottom, black, green);
                -webkit-transform: skewX(35deg);
                transform: skewX(35deg);
            }

            li label:hover:before {
                background: linear-gradient(to bottom, green, lightgreen);
                -webkit-transform: skewX(-35deg);
                transform: skewX(-35deg);
            }

            label[active] {
                background: rgba(53,122,232,0);
            }

            label[active]:before {
                -webkit-transform: skewX(-35deg);
                transform: skewX(-35deg);
                background: rgba(31, 109, 255,0.4);
            }

            label[active]:after {
                -webkit-transform: skewX(35deg);
                transform: skewX(35deg);
                background: rgba(31, 109, 255,0.4);
            }

            label[ghost] {
                background: rgba(128,128,128,0);
            }

            label[ghost]:before {
                background: rgba(128,128,128,0.5);
                -webkit-transform: skewX(-35deg);
                transform: skewX(-35deg);
            }

            label[ghost]:after {
                background: rgba(128,128,128,0.5);
                -webkit-transform: skewX(35deg);
                transform: skewX(35deg);
            }


            label {
                background: rgba(128, 128, 128,0);
            }

            label:before {
                background: rgba(128, 128, 128,1);
                -webkit-transform: skewX(-35deg);
                transform: skewX(-35deg);
            }

            label:after {
                background: rgba(128, 128, 128,1);
                -webkit-transform: skewX(35deg);
                transform: skewX(35deg);
            }

            li label {
                display: block;
                margin: 4px;
            }

            .options {
                height: 0;
                background: rgba(128, 128, 128, 0.9);
                position: absolute;
                display: none;
                width: 90%;
                height: 250px;
                transition: top 300ms cubic-bezier(0.17, 0.04, 0.03, 0.94);
                overflow: hidden;
                box-sizing: border-box;
                padding: 5px;
                z-index: 10;
            }

            .search {
                width: 100%;
                text-align: center;
                padding: 5px;
                font-size: smaller;
                box-sizing: border-box;
            }

            .options[expanded] {
                height: auto;
                display: block;
                min-height: 40px;
                max-height: 400px;
            }
        </style>
        <li class="block">
            <label active$="[[active]]" ghost$="[[ghost]]" on-click="expandDropdown" on-mouseover="onItemHover" on-mouseout="onItemBlur"><span>[[value]]</span> &nbsp; &#x2228;</label>
            <div class="options" expanded$="[[expanded]]">
                <input on-click="preventCollapse" type="text" value="{{searchQuery::input}}" class="search" placeholder="Search">
                <content></content>
            </div>
        </li>
    </template>
    <script>
        (function () {
            'use strict';

            Polymer({
                is: 'x-crumb',

                properties: {
                    dropdown: {
                        type: Boolean,
                        value: true,
                        notify: true
                    },
                    expanded: {
                        type: Boolean,
                        value: false,
                        notify: true,
                        reflectToAttribute: true
                    },
                    ghost: {
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                    active: {
                        type: Boolean,
                        value: false,
                        notify: true
                    },
                    searchQuery: {
                        type: String,
                        value: "",
                        notify: true
                    },
                    alloptions: {
                        type: Array,
                        value: [],
                        notify: true
                    },
                    add: {
                        type: Boolean,
                        value: false,
                        notify: true
                    }
                },
                attached: function () {
                    this.set("expanded", false);
                    document.body.addEventListener("click", function (e) {
                        setTimeout(function () {
                            if (this.hovered) {
                                return;
                            }

                            this.set("expanded", false);
                        }.bind(this), 100);
                    }.bind(this));
                },
                preventCollapse: function(ev) {
                    ev.stopPropagation();
                },
                expandDropdown: function (e) {
                    this.set("expanded", true);
                    e.preventDefault();
                },
                onItemHover: function () {
                    this.hovered = true;
                },
                onItemBlur: function () {
                    this.hovered = false;
                },
                value: function () { }
            });
        })();
    </script>
</dom-module>
